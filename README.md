# üß± –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –ö–ß–°

## üß≠ –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

* **Backend**: NestJS + PostgreSQL + WebSocket (gateway)
* **Frontend**: Next.js 15 App Router + TailwindCSS + Shadcn
* **Auth**: Cookie-based JWT, roles & permissions
* **Infra**: Redis (queues & pub/sub), MinIO/S3, PostGIS

---

## üì¶ Backend (NestJS)

### 1. `auth`

* –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –≤—Ö–æ–¥, refresh —Ç–æ–∫–µ–Ω—ã
* –ó–∞—â–∏—Ç–∞: `RolesGuard`, `PermissionsGuard`, `PoliciesGuard`
* Cookie-based —Å HttpOnly refresh

### 2. `users`

* –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã, —Ä–æ–ª–∏
* –°—Ç—Ä—É–∫—Ç—É—Ä–∞: –ì–ª–∞–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ‚Üí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ‚Üí –û—Ç–¥–µ–ª ‚Üí –û—Ç–¥–µ–ª–µ–Ω–∏–µ

### 3. `analytics`

* –ß–°-—Å–æ–±—ã—Ç–∏—è: CRUD
* –û—Ç—á—ë—Ç—ã –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º –∏ –ø–µ—Ä–∏–æ–¥–∞–º
* –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥—É–ª—è `prediction` (–ò–ò)

### 4. `documents`

* `incoming`, `outgoing`, `internal`
* –í–ª–æ–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã, —Å—Ç–∞—Ç—É—Å—ã, –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
* –ü—Ä–∏–≤—è–∑–∫–∞ –∫ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—É

### 5. `files`

* –ó–∞–≥—Ä—É–∑–∫–∞, —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫
* –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ –ø–æ —Ä–æ–ª—è–º
* –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 6. `gis`

* –ö–∞—Ä—Ç—ã –∏ —Å–ª–æ–∏: PostGIS
* –ß–° –∑–æ–Ω—ã, –æ–ø–∞—Å–Ω—ã–µ —É—á–∞—Å—Ç–∫–∏, –ø–æ–ª–∏–≥–æ–Ω—ã
* API –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ OpenLayers/Mapbox

### 7. `chat`

* –ö–æ–º–Ω–∞—Ç—ã, —Å–æ–æ–±—â–µ–Ω–∏—è
* WebSocket Gateway
* Seen, online, typing-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã

### 8. `calls`

* –í–∏–¥–µ–æ–∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏ —á–µ—Ä–µ–∑ WebRTC signaling
* –í–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∏ 1:1 –∏ –≥—Ä—É–ø–ø–æ–≤—ã–µ
* –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–∞–ª–µ–Ω–¥–∞—Ä—ë–º (–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)

---

## üß© Frontend (Next.js)

### Layout –∏ Shell

* AppSidebar: –¥–∏–Ω–∞–º–∏–∫–∞ + `CanAccess`
* Header: PageBreadcrumbs –ø–æ —Ç–µ–∫—É—â–µ–º—É –ø—É—Ç–∏
* AuthProvider + middleware.ts

### –†–æ—É—Ç–∏–Ω–≥

```
/analytics
/analytics/reports
/documents/incoming
/documents/outgoing
/files
/gis
/chat/:roomId
/calls/:id
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

* –¢–∞–±–ª–∏—Ü—ã —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
* Editor –¥–ª—è –æ—Ç—á—ë—Ç–æ–≤ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
* FileDropZone + TreeView
* OpenLayers –∫–∞—Ä—Ç–∞ —Å –ª–µ–≥–µ–Ω–¥–∞–º–∏ –∏ —Å–ª–æ—è–º–∏
* –ß–∞—Ç: Scroll + input + attachments
* –í–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∏: WebRTC media + controls

---

## üîí –î–æ—Å—Ç—É–ø –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

* `@Roles()`, `@Permissions()`, `@Policies()`
* Frontend: `CanAccess`, SSR middleware
* –ó–∞—â–∏—Ç–∞ API: rate-limit, csrf, XSS-safe

---

## ‚òÅÔ∏è –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

* **PostgreSQL** + **PostGIS**: –≥–µ–æ–¥–∞–Ω–Ω—ã–µ
* **Redis**: –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á + WebSocket pub/sub
* **MinIO**: —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
* **Sentry/Logtail**: –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
* **Docker + Docker Compose**

---

## üöß –í –¥–∞–ª—å–Ω–µ–π—à–µ–º

* –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ò–ò –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (FastAPI / Python)
* Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (Web + Mobile)
* –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ React Native Expo
* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (LiveMap + –≥–æ–ª–æ—Å–æ–≤–æ–π –≤—ã–∑–æ–≤)
